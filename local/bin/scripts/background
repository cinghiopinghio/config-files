#!/usr/bin/env bash
# set a random background from $DBLOC
# depends on feh

LOCATION=~/.local/share
FNAME=background
DBLOC=${LOCATION}/sfondi

randomlink (){
  sourcedir=$1
  linkname=$2
  #files=( ${sourcedir}/* )
  #rfile=$(printf "%s\n" "${files[RANDOM % ${#files[@]}]}")
  randfile=$(shuf -n 1 -e ${sourcedir}/*)
  ext=${randfile/*./}
  ln -s $randfile ${linkname}.${ext}
  echo $randfile
}

# check if bg images exist
if [ ! -d ${DBLOC} ];
then
  echo "Error: no source directory with pictures"
  exit 1
fi

rm -f ${LOCATION}/${FNAME}.*
orig=$(randomlink ${DBLOC} ${LOCATION}/${FNAME})


echo "Installing:" ${orig}
feh --bg-fill ${LOCATION}/${FNAME}.*

